<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Delivery App V3</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- LINE Front-end Framework (LIFF) SDK -->
    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <style>
        body { font-family: 'Inter', 'Kanit', sans-serif; }
        .card { background-color: white; border-radius: 1rem; box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); }
        .btn-primary { background: linear-gradient(to right, #06C755, #04A546); color: white; font-weight: bold; border-radius: 0.75rem; padding: 0.75rem 1.5rem; transition: transform 0.2s; }
        .btn-primary:hover { transform: scale(1.05); }
        .input-group { position: relative; margin-bottom: 1.25rem; }
        .input-field { width: 100%; padding: 0.75rem 1rem 0.75rem 2.5rem; border-radius: 0.75rem; border: 1px solid #D1D5DB; }
        .input-field:focus { outline: none; border-color: #06C755; box-shadow: 0 0 0 3px rgba(6, 199, 85, 0.2); }
        .input-icon { position: absolute; left: 0.75rem; top: 50%; transform: translateY(-50%); color: #9CA3AF; }
    </style>
</head>
<body class="bg-gray-100">

    <div id="loading" class="flex items-center justify-center h-screen">
        <div class="text-center">
            <i class="fas fa-spinner fa-spin text-4xl text-green-600"></i>
            <p class="mt-2 text-gray-600">กำลังโหลดข้อมูล...</p>
        </div>
    </div>

    <div id="app" class="hidden max-w-lg mx-auto p-4">
        <div id="profile" class="card p-4 mb-6 flex items-center space-x-4">
            <img id="userPicture" class="w-16 h-16 rounded-full border-2 border-green-500" src="https://placehold.co/100x100/EFEFEF/AAAAAA?text=User" alt="User Profile Picture">
            <div>
                <p class="text-gray-600">สวัสดีครับ</p>
                <h1 id="userName" class="text-xl font-bold text-gray-800">...</h1>
            </div>
        </div>
        <div id="order-form" class="card p-6">
            <h2 class="text-2xl font-bold text-center mb-6 text-gray-800">เรียกไรเดอร์ส่งของ</h2>
            <div class="input-group">
                <i class="fas fa-map-marker-alt input-icon"></i>
                <input type="text" id="pickup" class="input-field" placeholder="จุดรับของ (ต้นทาง)">
            </div>
            <div class="input-group">
                <i class="fas fa-flag-checkered input-icon"></i>
                <input type="text" id="destination" class="input-field" placeholder="จุดส่งของ (ปลายทาง)">
            </div>
            <button id="submitBtn" class="w-full btn-primary">
                <i class="fas fa-motorcycle mr-2"></i>ยืนยันการเรียก
            </button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const loadingEl = document.getElementById('loading');
            const appEl = document.getElementById('app');

            async function main() {
                try {
                    // --- ใส่ LIFF ID ของคุณตรงนี้ ---
                    await liff.init({ liffId: "2007930661-v85jNpQb" });
                    
                    if (!liff.isLoggedIn()) {
                        liff.login();
                        return;
                    }
                    
                    const profile = await liff.getProfile();
                    document.getElementById('userName').textContent = profile.displayName;
                    document.getElementById('userPicture').src = profile.pictureUrl;

                    loadingEl.classList.add('hidden');
                    appEl.classList.remove('hidden');

                } catch (error) {
                    console.error('LIFF Initialization failed', error);
                    loadingEl.innerHTML = `<p class="text-red-500">เกิดข้อผิดพลาดในการเชื่อมต่อกับ LINE กรุณาตรวจสอบการตั้งค่า</p>`;
                }
            }
            main();
        });
    </script>
</body>
</html>
